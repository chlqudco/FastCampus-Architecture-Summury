- 가장 미지의 영역으로 남아 있는 것이 도메인 계층을 어떻게 설계할 것인가에 대한 것

- 강사가 생각하는 가장 중요한 클립임
	- 왜 인지는 차차 생각

---

- 사고 실험을 해보자
	- 쿠팡을 새로 만들어야 한다고 생각해보자
	- 기존의 것을 아무것도 안쓰고 처음부터 만든다고 가정 (Greenfield Project)
	- 당신이 개발팀의 총 책임자라면 2~3개월간 무얼 할건가?
	- 아래는 여러 경우의 수

- 1. 기다린다
	- 기획도.. 디자인도 없는데 개발을..?
	- 이런 저런 회의들도 많고.. 개발자도 더 뽑아야 하고..

- 2. 뭐라도 한다 1
	- 데이터 스키마 설계, 필요한 엔티티 들을 도출한다
	- 각 엔티티의 관계의 연결을 정의해본다

- 3. 뭐라도 한다 2
	- 화면 중심 설계, 확실히 필요할 것처럼 보이는 화면의 요소를 여기저기 만들어보자
	- 전체 화면 구성을 대충 도출해보고 내비게이션의 뼈대를 만들어 본다
	- 꼭 필요한 애니메이션이나 복잡한 UI를 미리 구현한다

- 4. 기술적으로 준비한다
	- 프로토타이핑, 기술적으로 어려운 부분이 있을 것 같으면 그에대한 유력한 해결책을 검토해보는 Proof of Concept를 만들어본다

---

- 그러나 데이터 중심의 설계란 없다
	- 사실 2번처럼 데이터 중심으로 뭔가 많이 한다
	- DB를 만들었을지언정 앱에 어떻게 구현이 될까 라는 건 전혀 도움이 안됨
	- 도메인이랑 DB랑 별 관련이 없기 때문에

- 가장 좋은 것은 가장 중요하고, 잘 변하지 않는 것(비즈니스의 목표, 핵심적인 사용자 시나리오)부터 시작하기
	- 쿠팡에선 상품 구매, 결제, 상품 보여주는 방식 등의 주요 기능을 생각하자
	- 기획자/비즈니스 부서와 함께 핵심 사용자 시나리오(Critical User Journey)를 정하자
	- 그리고 핵심 사용자 시나리오를 코드로 옮긴다
		- 데이터, UI 등 가변요소는 모두 배제
		- 로직을 미리 검증하고 테스트하면 실 프로젝트에 그대로 사용 가능
	- 예를들어 회원 전용 기능 시나리오를 생각해보자
		- 가변요소로는 회원 정보를 어떻게 저장할지, 회원 가입 과정이 몇 페이지에 걸쳐서 이뤄질 지 등
		- 불변 요소로는 회원에게 어떤 정보를 꼭 받아야 하는지, 회원과 비회원의 차이는 무엇인지 

- 이것이 DDD의 전부이다

---

- 도메인 계층에 대한 얘기를 시작해보자

- 도메인 계층은 무엇인가?
	- UI 계층에서 사용되기 위한, 캡슐화 된 비즈니스 로직들을 모아 놓은 곳
	- 도메인 계층의 비즈니스 로직은 UI 계층과는 다름
		- 진짜 사업자? 같은 사람들이 정하는 로직임
		- UI 계층의 로직은 사용자의 입력이나 이벤트를 처리하는 로직

- 왜 UI로직과 나누어야 하는가?
	- UI 계층과 데이터 계층 사이에 있는 책임들을 분리해줌
		- 두 계층의 액터는 다름
	- 도메인 분리로 비즈니스의 규칙/전략의 변경이 타 계층에 영향을 주지 않음
	- 코드 중복을 합리적으로 줄여 줌
	- 테스트 가능성이 증진함. 비즈니스 룰 만을 격리해서 테스트 할 수 있음

- 도메인 레이어에서 하는 일
	- 도메인 비즈니스 로직
	- 데이터의 변환
		- 데이터 계층을 통해 전달 받은 엔티티를 앱의 도메인 관점에서 필요한 형태로 변환

- 왜 도메인 계층을 잘 설계하는 것이 중요한가?
	- UI 계층과 데이터 계층 사이의 미드필더가 없을 때 생기는 설계상의 문제를 해결해줌
	- 로직이 UI에 너무 집중한다면
		- 화면 중심적 사고를 하게됨. 그럼 화면을 넘나드는 로직들에 대한 처리를 어떻게 하나?
		- 애자일 프로세스가 오히려 좋은 설계를 방해하게 됨
	- 데이터 엔티티에만 집중한다면
		- 도메인 계층과 데이터 계층을 데이터 스키마 중심으로 설계하는 것은 매우 전형적인 설계 오류


- DDD란 무엇인가
	- 프로세스에 대한 깊은 지식을 담고 있는 도메인 모델과 도메인 규칙들의 개발을 중심에 놓는 개발 방법
	- 어려운 이유는 추상화하기 힘들기 때문?
		- UI 층이나 data 층은 보다 명확하지만 도메인은 정답이 없기 때문에 굉장히 어려움

- 왜 모바일 개발자도 DDD를 알아야 하는가
	- 모바일 개발자 입장에서 이제까지 큰 설계에 있어 UI 계층과 데이터 계층을 어떻게 연결할 것인가에 대해 접할 정보가 거의 없음
	- 화면 중심 사고로 도메인이나 데이터 계층을 다루는 것은 좋지 않은 생각임
	- DDD는 불변하는 도메인을 어떻게 올바르고 효과적으로 설계하는 지 알려줌
